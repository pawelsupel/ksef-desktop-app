<div class="settings-container">
  <h2>Ustawienia</h2>

  <div class="settings-section">
    <h3>Konfiguracja Integracji z KSeF</h3>

    <form [formGroup]="settingsForm" (ngSubmit)="saveSettings()">
      <div class="form-group">
        <label>Metoda Autentykacji:</label>
        <div class="auth-method-info">
          <strong>Token KSeF (Aktualnie obsÅ‚ugiwane)</strong> âœ“
        </div>
        <small>Certyfikat kwalifikowany bÄ™dzie dodany w przyszÅ‚ych wersjach</small>
      </div>

      <!-- Token Authentication Fields -->
      <div *ngIf="authMethod === 'token'">
        <div class="form-group">
          <label for="token">Token KSeF:</label>
          <input type="password" id="token" formControlName="token" placeholder="Pole bÄ™dzie puste jeÅ›li token jest zapisany - wklej nowy aby zmieniÄ‡" />
          <small>
            â„¹ï¸ Pole autoryzacyjne bÄ™dzie puste jeÅ›li token jest juÅ¼ zapisany (bezpieczeÅ„stwo)
            <br/>Pobierz token z panelu: <a href="https://ksef.mf.gov.pl/" target="_blank">https://ksef.mf.gov.pl</a>
            <br/>Format: referenceNumber|nipIdentifier|tokenValue
            <br/>â„¹ï¸ NIP zostanie automatycznie wyciÄ…gniÄ™ty z tokenu
          </small>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" [disabled]="!settingsForm.valid || isSaving">
          {{ isSaving ? 'Zapisywanie...' : 'Zapisz Ustawienia' }}
        </button>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="error-message">
        âœ— {{ errorMessage }}
      </div>

      <!-- Success Message -->
      <div *ngIf="savedSuccessfully" class="success-message">
        âœ“ Ustawienia zostaÅ‚y zapisane pomyÅ›lnie
      </div>

      <!-- Connection Status -->
      <div *ngIf="connectionStatus !== 'idle'" class="connection-status"
           [ngClass]="{
             'status-testing': connectionStatus === 'testing',
             'status-success': connectionStatus === 'success',
             'status-error': connectionStatus === 'error'
           }">
        <div *ngIf="connectionStatus === 'testing'">
          ğŸ”„ {{ connectionMessage }}
        </div>
        <div *ngIf="connectionStatus === 'success'">
          âœ… {{ connectionMessage }}
        </div>
        <div *ngIf="connectionStatus === 'error'">
          âŒ {{ connectionMessage }}
        </div>
      </div>
    </form>
  </div>

  <div class="settings-section">
    <h3>Dokumentacja KSeF</h3>
    <p>Aby uzyskaÄ‡ token lub certyfikat, odwiedÅº:</p>
    <ul>
      <li><a href="https://ksef.mf.gov.pl/web/ksef" target="_blank">Portal KSeF</a></li>
      <li><a href="https://www.podatki.gov.pl/" target="_blank">MÃ³j PIT</a></li>
    </ul>
  </div>
</div>
