<div class="ksef-portal-container">
  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-content">
      <h2>‚ö†Ô∏è B≈ÇƒÖd</h2>
      <p>{{ error }}</p>
      <button class="btn-primary" routerLink="/settings">
        Przejd≈∫ do Ustawie≈Ñ
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="!isLoggedIn && !error" class="loading-state">
    <div class="spinner"></div>
    <p>‚è≥ ≈Åadowanie portalu KSeF...</p>
  </div>

  <!-- Portal Container -->
  <div *ngIf="isLoggedIn" class="portal-wrapper">
    <!-- Toolbar -->
    <div class="portal-toolbar">
      <div class="toolbar-title">üìä Portal KSeF</div>
      <button
        class="btn-refresh"
        (click)="refresh()"
        title="Od≈õwie≈º portal">
        üîÑ Od≈õwie≈º
      </button>
    </div>

    <!-- iFrame -->
    <div class="iframe-container" [class.loading]="!isLoaded">
      <iframe
        #kSefFrame
        [src]="kSefUrl | sanitize"
        (load)="onIframeLoaded()"
        (error)="onIframeError()"
        class="ksef-iframe"
        title="Portal KSeF"
        allow="payment">
      </iframe>

      <!-- Loading Overlay -->
      <div *ngIf="!isLoaded" class="iframe-loading">
        <div class="spinner-small"></div>
        <p>‚è≥ Za≈Çadowanie portalu KSeF...</p>
      </div>
    </div>
  </div>
</div>
